import{W as x,r as F,m as G,V as Q,A as J,D as K,X as W,o,a as m,b as a,t as u,d as r,w,v as P,J as y,p as N,Y as X,F as D,e as Y,q as h,f as Z,n as _,T as p,Z as $,$ as H,a7 as ee,a0 as te,aN as ie,a2 as L,I as ne,a3 as ae,Q as se,N as re,aK as T,aJ as C,C as q,B as le}from"./bIp8vrNC.js";import{d as de}from"./BvQgWdB0.js";import{S as U}from"./z1mF-5nA.js";import oe from"./ItgtrmpN.js";var O={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"FormPreRegistrationMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"data"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"FormPreRegistrationInput"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"result"},name:{kind:"Name",value:"FormPreRegistration"},arguments:[{kind:"Argument",name:{kind:"Name",value:"data"},value:{kind:"Variable",name:{kind:"Name",value:"data"}}}],directives:[]}]}}],loc:{start:0,end:121}};O.loc.source={body:"mutation FormPreRegistrationMutation ($data: FormPreRegistrationInput!) {\n    result: FormPreRegistration (data: $data)\n}",name:"GraphQL request",locationOffset:{line:1,column:1}};function E(e,t){if(e.kind==="FragmentSpread")t.add(e.name.value);else if(e.kind==="VariableDefinition"){var i=e.type;i.kind==="NamedType"&&t.add(i.name.value)}e.selectionSet&&e.selectionSet.selections.forEach(function(n){E(n,t)}),e.variableDefinitions&&e.variableDefinitions.forEach(function(n){E(n,t)}),e.definitions&&e.definitions.forEach(function(n){E(n,t)})}var M={};(function(){O.definitions.forEach(function(t){if(t.name){var i=new Set;E(t,i),M[t.name.value]=i}})})();function A(e,t){for(var i=0;i<e.definitions.length;i++){var n=e.definitions[i];if(n.name&&n.name.value==t)return n}}function ue(e,t){var i={kind:e.kind,definitions:[A(e,t)]};e.hasOwnProperty("loc")&&(i.loc=e.loc);var n=M[t]||new Set,s=new Set,d=new Set;for(n.forEach(function(l){d.add(l)});d.size>0;){var g=d;d=new Set,g.forEach(function(l){if(!s.has(l)){s.add(l);var v=M[l]||new Set;v.forEach(function(S){d.add(S)})}})}return s.forEach(function(l){var v=A(e,l);v&&i.definitions.push(v)}),i}ue(O,"FormPreRegistrationMutation");var V={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"EventDetailQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"event"},name:{kind:"Name",value:"Event"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"date"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"city"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"image"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"length"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"length"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"measure"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"total"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"preview"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"image"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"text"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"offers"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"available"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"price"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"value"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"original"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"currency"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"members_min"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"members_max"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"button"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"registration_url"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"volunteers_url"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"pre_registration"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"open"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"registration_end"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"documents"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"tabs"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"result"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:733}};V.loc.source={body:"query EventDetailQuery ($id: String!) {\n    event: Event (id: $id) {\n        id\n        title\n        url\n        date\n        city\n        type {\n            id\n            title\n            url\n            image\n            length {\n                type\n                length\n                measure\n            }\n            total\n        }\n        preview\n        image\n        text\n        status\n		offers {\n			id\n			title\n			type\n			available\n			price {\n				value\n				original\n				currency\n			}\n            members_min\n            members_max\n		}\n        button\n        registration_url\n        volunteers_url\n        pre_registration\n        open\n        registration_end\n        documents\n        tabs\n        result\n    }\n}",name:"GraphQL request",locationOffset:{line:1,column:1}};function R(e,t){if(e.kind==="FragmentSpread")t.add(e.name.value);else if(e.kind==="VariableDefinition"){var i=e.type;i.kind==="NamedType"&&t.add(i.name.value)}e.selectionSet&&e.selectionSet.selections.forEach(function(n){R(n,t)}),e.variableDefinitions&&e.variableDefinitions.forEach(function(n){R(n,t)}),e.definitions&&e.definitions.forEach(function(n){R(n,t)})}var B={};(function(){V.definitions.forEach(function(t){if(t.name){var i=new Set;R(t,i),B[t.name.value]=i}})})();function I(e,t){for(var i=0;i<e.definitions.length;i++){var n=e.definitions[i];if(n.name&&n.name.value==t)return n}}function me(e,t){var i={kind:e.kind,definitions:[I(e,t)]};e.hasOwnProperty("loc")&&(i.loc=e.loc);var n=B[t]||new Set,s=new Set,d=new Set;for(n.forEach(function(l){d.add(l)});d.size>0;){var g=d;d=new Set,g.forEach(function(l){if(!s.has(l)){s.add(l);var v=B[l]||new Set;v.forEach(function(S){d.add(S)})}})}return s.forEach(function(l){var v=I(e,l);v&&i.definitions.push(v)}),i}me(V,"EventDetailQuery");const ve={class:"is-modal-content white-bg"},ce={class:"form-group"},fe={class:"form-group"},ke={class:"form-group"},ge={key:0,class:"form-group"},he={class:"select-wrap small-select full-width"},pe=a("option",{value:""},"...",-1),ye=["value"],Ne=a("div",{class:"arrow-down"},[a("i",{class:"icon icon-arrow-down"})],-1),be={__name:"PreRegistration",props:{event:{type:Object}},setup(e){const t=e,{t:i}=x(),n=F(""),s=F(""),d=F(""),g=F(""),{user:l}=G(Q());l.value&&(n.value=l.value.name,s.value=l.value.last_name,d.value=l.value.email);const v=F(null);J(async()=>{v.value=await K(V,{id:String(t.event.id)}).then(({event:c})=>c)});const b=W({name:{required:$},last_name:{required:$},email:{required:$,emailValidation:H},offer:{required:$}},{name:n,last_name:s,email:d,offer:g},{$autoDirty:!0});async function j(){if(await b.value.$validate()){ee();try{await te(O,{data:{competition:t.event.id||0,name:n.value,last_name:s.value,email:d.value,offer:g.value}}),await ie(),L(i("registration.send_request.success"),i("registration.send_request.success_message"))}catch(c){ne(c)}}}return(c,f)=>{const z=ae;return o(),m("div",ve,[a("h3",null,u(c.$t("events.preregistration")),1),r(),a("form",{action:"",method:"post",onSubmit:f[4]||(f[4]=p(()=>{},["prevent"]))},[a("div",ce,[a("label",null,u(c.$t("personal.fields.name")),1),r(),w(a("input",{class:y({error:N(b).name.$error}),type:"text",name:"name","onUpdate:modelValue":f[0]||(f[0]=k=>n.value=k)},null,2),[[P,n.value]])]),r(),a("div",fe,[a("label",null,u(c.$t("personal.fields.last_name")),1),r(),w(a("input",{class:y({error:N(b).last_name.$error}),type:"text",name:"last_name","onUpdate:modelValue":f[1]||(f[1]=k=>s.value=k)},null,2),[[P,s.value]])]),r(),a("div",ke,[a("label",null,u(c.$t("personal.fields.email")),1),r(),w(a("input",{class:y({error:N(b).email.$error}),type:"email",name:"email","onUpdate:modelValue":f[2]||(f[2]=k=>d.value=k)},null,2),[[P,d.value]])]),r(),v.value?(o(),m("div",ge,[a("label",null,u(c.$t("registration.participation")),1),r(),a("div",he,[w(a("select",{class:y([{error:N(b).offer.$error},"full-width"]),"onUpdate:modelValue":f[3]||(f[3]=k=>g.value=k),name:"offer",tabindex:"1"},[pe,r(),(o(!0),m(D,null,Y(v.value.offers,k=>(o(),m("option",{value:k.id},u(c.$t("race_types."+k.type)),9,ye))),256))],2),[[X,g.value]]),r(),Ne])])):h("",!0),r(),Z(z,{callback:j,class:"btn-primary"},{default:_(()=>[r(u(c.$t("registration.send_request.submit")),1)]),_:1})],32)])}}},Fe={class:"event-item-wrap"},Se=["href","title"],we={class:"event-item-head"},$e={class:"title"},De={class:"event-head-info"},Ee={class:"date"},Re={key:0,class:"place"},Oe={class:"event-image"},Ve=["srcset"],Pe=["srcset"],Me=["src","alt"],Be={key:0,class:"event-footer"},Te={class:"hover-buttons"},Ce=["href"],qe=["href"],Ae={name:"EventItem",components:{StageItem:U},props:{item:{type:Object}},computed:{...se(Q,["user"]),isExternal(){return this.item.url.indexOf("http")>=0},inBasket(){return this.user&&this.user.basket&&this.user.basket.indexOf(this.item.id)>-1},isResultPage(){return this.item.url.indexOf("/results/")>=0},title(){return this.item.type&&this.item.type.title.toUpperCase().indexOf("ONLINE")===-1?this.item.type.title:this.item.title},caption(){return this.item.title+" - "+re(this.item.date).tz().format("DD.MM.YYYY")+" - "+this.item.city}},methods:{click(){this.isExternal?window.open(this.item.url):T(this.item.url)},authPopup(){C(oe,{class:"is-modal-content white-bg",onLogin:()=>{T(this.item.registration_url)}})},inBasketAlert(){L(this.$t("forms.error"),this.$t("forms.in_basket"))},preRegistration(){C(be,{event:this.item})}}},Le=Object.assign(Ae,{setup(e){return(t,i)=>{const n=le;return o(),m("div",Fe,[a("a",{href:e.item.url,onClick:i[0]||(i[0]=p((...s)=>t.click&&t.click(...s),["prevent"])),title:t.caption,class:"event-item"},[a("div",we,[a("div",$e,u(t.title),1),r(),a("div",De,[a("div",Ee,u(t.$formatDate(e.item.date,"DD.MM.YYYY")),1),r(),e.item.city?(o(),m("div",Re,u(e.item.city),1)):h("",!0)])]),r(),a("div",Oe,[a("picture",null,[e.item.image?(o(),m(D,{key:0},[a("source",{media:"(max-width: 1024px)",srcset:e.item.image["1x"]+" 1x, "+e.item.image["2x"]+" 2x"},null,8,Ve),r(),a("source",{media:"(min-width: 1025px)",srcset:e.item.image["1x"]+" 1x, "+e.item.image["3x"]+" 2x"},null,8,Pe)],64)):h("",!0),r(),a("img",{src:e.item.image?e.item.image["3x"]:N(de),alt:t.title,loading:"lazy"},null,8,Me)]),r(),e.item.status?(o(),m("div",{key:0,class:y(["old-event-label",[t.$te("events.status."+e.item.status)?"status-"+e.item.status:"status-OPEN_SOON"]])},u(t.$te("events.status."+e.item.status)?t.$t("events.status."+e.item.status):e.item.status),3)):h("",!0)]),r(),e.item.type&&e.item.type.length&&e.item.type.length.length?(o(),m("div",Be,[a("div",{class:y(["triathlon",{"justify-content-around":e.item.type.length.length<3}])},[(o(!0),m(D,null,Y(e.item.type.length,(s,d)=>(o(),q(N(U),{stage:s,key:d,class:"triathlon-item"},null,8,["stage"]))),128))],2)])):h("",!0)],8,Se),r(),a("div",Te,[e.item.pre_registration?(o(),m("a",{key:0,onClick:i[1]||(i[1]=p((...s)=>t.preRegistration&&t.preRegistration(...s),["prevent"])),href:"",class:"btn btn-white"},u(t.$t("events.preregistration")),1)):e.item.registration_url?(o(),m(D,{key:1},[e.item.registration_url.indexOf("http")>=0?(o(),m("a",{key:0,href:e.item.registration_url,class:"btn btn-white"},u(t.$t("events.registration")),9,Ce)):t.inBasket?(o(),m("a",{key:1,onClick:i[2]||(i[2]=p((...s)=>t.inBasketAlert&&t.inBasketAlert(...s),["prevent"])),href:"",class:"btn btn-white"},u(t.$t("events.registration")),1)):t.user?(o(),q(n,{key:2,to:e.item.registration_url,class:"btn btn-white"},{default:_(()=>[r(u(t.$t("events.registration")),1)]),_:1},8,["to"])):(o(),m("a",{key:3,onClick:i[3]||(i[3]=p((...s)=>t.authPopup&&t.authPopup(...s),["prevent"])),href:"",class:"btn btn-white"},u(t.$t("events.registration")),1))],64)):h("",!0),r(),a("a",{href:e.item.url,onClick:i[4]||(i[4]=p((...s)=>t.click&&t.click(...s),["prevent"])),class:"btn btn-white"},u(t.$t("events.read_more"+(t.isResultPage?"_result":""))),9,qe)])])}}});export{Le as _,be as a,V as d};
