import{r as Y,X as C,Z as g,o as c,a as m,b as e,J as b,p as _,d as s,T as x,t as r,q as w,c as F,w as y,Y as U,F as k,e as V,v as N,_ as G,Q as J,V as K,z as X,aY as q,a6 as Z,bf as W,$ as ee,a7 as te,L as ae,a0 as se,a8 as P,aK as j,aL as z,I as ne,S as B,C as I,P as ie,f as $,n as oe,g as le,a3 as de,aa as re}from"./bIp8vrNC.js";import{_ as ce}from"./CNmUNVPL.js";import{u as me}from"./B_dvM0pQ.js";var T={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"SearchTeamMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"data"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Objects"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"result"},name:{kind:"Name",value:"SearchTeamAdd"},arguments:[{kind:"Argument",name:{kind:"Name",value:"data"},value:{kind:"Variable",name:{kind:"Name",value:"data"}}}],directives:[]}]}}],loc:{start:0,end:89}};T.loc.source={body:"mutation SearchTeamMutation ($data: Objects!) {\n    result: SearchTeamAdd (data: $data)\n}",name:"GraphQL request",locationOffset:{line:1,column:1}};function D(t,n){if(t.kind==="FragmentSpread")n.add(t.name.value);else if(t.kind==="VariableDefinition"){var a=t.type;a.kind==="NamedType"&&n.add(a.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(i){D(i,n)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(i){D(i,n)}),t.definitions&&t.definitions.forEach(function(i){D(i,n)})}var O={};(function(){T.definitions.forEach(function(n){if(n.name){var a=new Set;D(n,a),O[n.name.value]=a}})})();function Q(t,n){for(var a=0;a<t.definitions.length;a++){var i=t.definitions[a];if(i.name&&i.name.value==n)return i}}function ue(t,n){var a={kind:t.kind,definitions:[Q(t,n)]};t.hasOwnProperty("loc")&&(a.loc=t.loc);var i=O[n]||new Set,h=new Set,l=new Set;for(i.forEach(function(d){l.add(d)});l.size>0;){var p=l;l=new Set,p.forEach(function(d){if(!h.has(d)){h.add(d);var u=O[d]||new Set;u.forEach(function(v){l.add(v)})}})}return h.forEach(function(d){var u=Q(t,d);u&&a.definitions.push(u)}),a}ue(T,"SearchTeamMutation");const ve={class:"row"},fe={class:"col-md-9 col-8 col-xxs-12"},he=["value"],_e=e("div",{class:"remove-btn-wrap visible-xxs"},[e("a",{href:"#",class:"remove-btn"},[e("i",{class:"icon-minus icon"})])],-1),pe={class:"col-md-3 col-4 col-xxs-12"},ge={key:0,class:"remove-btn-wrap hidden-xxs"},be=e("i",{class:"icon-minus icon"},null,-1),ye={__name:"Name",props:{index:{type:Number},modelValue:{type:String}},emits:["delete","update:modelValue"],setup(t,{emit:n}){const i=Y(t.modelValue),h=n,l=C({name:{required:g}},{name:i},{$autoDirty:!0});return(p,d)=>(c(),m("div",ve,[e("div",fe,[e("input",{class:b({error:_(l).name.$error}),type:"text",value:_(i),onInput:d[0]||(d[0]=u=>h("update:modelValue",u.target.value))},null,42,he),s(),_e]),s(),e("div",pe,[t.index>0?(c(),m("div",ge,[e("a",{href:"#",onClick:d[1]||(d[1]=x(u=>h("delete"),["prevent"])),class:"remove-btn"},[be,s(" "+r(p.$t("searchteam.form.delete")),1)])])):w("",!0)])]))}},ke={class:"row"},we={class:"col-md-4 col-5 col-xxs-12"},Se={class:"select-wrap"},$e={value:""},Ve=["value","disabled"],xe=e("div",{class:"arrow-down"},[e("i",{class:"icon icon-arrow-down"})],-1),Ne={class:"col-md-5 col-7 col-xxs-12"},De={class:"enter-distance"},Te={class:"text1"},Ue={class:"text2"},Oe={key:0,class:"remove-btn-wrap visible-xxs"},Ce=e("a",{href:"#",class:"remove-btn"},[e("i",{class:"icon-minus icon"})],-1),Ee=[Ce],Le={class:"col-md-3"},Ae={key:0,class:"remove-btn-wrap hidden-xxs"},Me=e("i",{class:"icon-minus icon"},null,-1),Re={__name:"Stage",props:{stages:{type:Array,default:()=>[]},fields:{type:Object},index:{type:Number},modelValue:{type:Object}},emits:["delete"],setup(t,{emit:n}){const a=t,i=F(()=>a.modelValue),h=n,l=F(()=>a.fields.stage.map(d=>d.type)),p=C({stage:{type:{required:g}}},{stage:i},{$autoDirty:!0});return(d,u)=>(c(),m("div",ke,[e("div",we,[e("div",Se,[y(e("select",{class:b([{error:_(p).stage.type.$error},"full-width"]),"onUpdate:modelValue":u[0]||(u[0]=v=>_(i).type=v)},[e("option",$e,"("+r(d.$t("searchteam.form.not_selected"))+")",1),s(),(c(!0),m(k,null,V(t.stages,v=>(c(),m("option",{value:v,disabled:_(l).indexOf(v)>=0},r(d.$t("stages."+v)),9,Ve))),256))],2),[[U,_(i).type]]),s(),xe])]),s(),e("div",Ne,[e("div",De,[e("span",Te,r(d.$t("searchteam.form.distance")),1),s(),y(e("input",{type:"text","onUpdate:modelValue":u[1]||(u[1]=v=>_(i).length=v),class:"distance-input"},null,512),[[N,_(i).length]]),s(),e("span",Ue,r(d.$t("metric.km")),1)]),s(),t.index>0?(c(),m("div",Oe,Ee)):w("",!0)]),s(),e("div",Le,[t.index>0?(c(),m("div",Ae,[e("a",{href:"#",onClick:u[2]||(u[2]=x(v=>h("delete"),["prevent"])),class:"remove-btn"},[Me,s(" "+r(d.$t("searchteam.form.delete")),1)])])):w("",!0)])]))}},Fe=re(ce),qe={name:"SearchTeamForm",components:{Name:ye,Stage:Re},props:{events:{type:Array},fields:{type:Object},goals:{type:Array}},setup(){return{v$:C({$autoDirty:!0})}},computed:{...J(K,["isAuthorized"]),event(){return this.events.find(t=>t.id===this.fields.event)},eventStages(){let t=[];for(let n in this.event.length)this.event.length.hasOwnProperty(n)&&t.push(n);return t},type(){return X().query.type||"user"}},watch:{"fields.stage":{handler(t){t.forEach((n,a)=>{this.event.length[n.type]&&!this.fields.stage[a].length.length&&(this.fields.stage[a].length=this.event.length[n.type].length||"")})},deep:!0}},validations:{fields:{goal:{required:g,minValue:q(1)},event:{required:g,minValue:q(1)},comment:{required:g},contact:{phone:{required:g,phoneValidator:Z,minLength:W(5)},email:{required:g,email:ee}}}},methods:{addStage(){this.fields.stage.push({type:"",length:""})},deleteStage(t){this.fields.stage.splice(t,1)},addName(){this.fields.name.push("")},deleteName(t){this.fields.name.splice(t,1)},async send(){if(!await this.v$.$validate()){let t=document.querySelector("form .error, .error");t&&me(t);return}te();try{let t=this.fields;t.type=this.type,this.isAuthorized||(t.captcha=await grecaptcha.execute(ae().public.recaptchaId,{action:"submit"})),await se(T,{data:t}),P(),t.id===0?j(z()("/searchteam/"+this.type)):j(z()("/personal/search/"))}catch(t){ne(t)}P()}}},Pe={class:"form-group sel-distance"},je={value:"0"},ze=["value"],Be=e("div",{class:"arrow-down"},[e("i",{class:"icon icon-arrow-down"})],-1),Ie=e("div",{class:"form-divider"},null,-1),Qe={class:"form-group some-inputs"},He={class:"ad-stage-block"},Ye={key:0,class:"add-btn-wrap"},Ge=e("i",{class:"icon-plus icon"},null,-1),Je=e("div",{class:"form-divider"},null,-1),Ke={class:"form-group some-inputs stage-block"},Xe={class:"ad-stage-block"},Ze={key:0,class:"add-btn-wrap"},We=e("i",{class:"icon-plus icon"},null,-1),et=e("div",{class:"form-divider"},null,-1),tt={class:"form-group textarea-group"},at={class:"select-wrap"},st={value:"0"},nt=["value"],it=e("div",{class:"arrow-down"},[e("i",{class:"icon icon-arrow-down"})],-1),ot={class:"form-group textarea-group"},lt=e("div",{class:"form-divider"},null,-1),dt={class:"form-group some-inputs"},rt={class:"input-with-icon"},ct={class:"icon"},mt={class:"input-with-icon"},ut={class:"icon"},vt={class:"input-with-icon"},ft={class:"icon"},ht=e("div",{class:"form-divider"},null,-1),_t={class:"form-group no-label text18"},pt=["innerHTML"],gt=e("div",{class:"form-divider"},null,-1);function bt(t,n,a,i,h,l){var E,L,A,M,R;const p=B("Name"),d=B("Stage"),u=Fe,v=le,H=de;return c(),m("form",{action:"",method:"post",onSubmit:n[8]||(n[8]=x((...o)=>l.send&&l.send(...o),["prevent"]))},[e("div",Pe,[e("label",null,r(t.$t("searchteam.table.event")),1),s(),e("div",null,[y(e("select",{class:b([{error:(E=i.v$.fields)==null?void 0:E.event.$error},"full-width"]),name:"event","onUpdate:modelValue":n[0]||(n[0]=o=>a.fields.event=o),tabindex:"1"},[e("option",je,"("+r(t.$t("searchteam.form.not_selected"))+")",1),s(),(c(!0),m(k,null,V(a.events,o=>(c(),m("option",{value:o.id},r(o.title),9,ze))),256))],2),[[U,a.fields.event]]),s(),Be])]),s(),Ie,s(),l.event?(c(),m(k,{key:0},[e("div",Qe,[e("label",null,r(t.$t("searchteam.table.who")),1),s(),e("div",He,[(c(!0),m(k,null,V(a.fields.name,(o,f)=>(c(),I(p,{key:f,index:f,modelValue:a.fields.name[f],"onUpdate:modelValue":S=>a.fields.name[f]=S,onDelete:S=>l.deleteName(f)},null,8,["index","modelValue","onUpdate:modelValue","onDelete"]))),128))]),s(),(t._.provides[ie]||t.$route).query.type==="team"&&l.event&&a.fields.name.length<l.eventStages.length-1?(c(),m("div",Ye,[e("a",{href:"#",onClick:n[1]||(n[1]=x(o=>l.addName(),["prevent"])),class:"add-btn"},[Ge,s(" "+r(t.$t("searchteam.form.add")),1)])])):w("",!0)]),s(),Je,s(),e("div",Ke,[e("label",null,r(t.$t("searchteam.table.stage")),1),s(),e("div",Xe,[(c(!0),m(k,null,V(a.fields.stage,(o,f)=>(c(),I(d,{key:f,fields:a.fields,stages:l.eventStages,index:f,modelValue:a.fields.stage[f],"onUpdate:modelValue":S=>a.fields.stage[f]=S,onDelete:S=>l.deleteStage(f)},null,8,["fields","stages","index","modelValue","onUpdate:modelValue","onDelete"]))),128))]),s(),a.fields.stage.length<l.eventStages.length?(c(),m("div",Ze,[e("a",{href:"#",onClick:n[2]||(n[2]=x(o=>l.addStage(),["prevent"])),class:"add-btn"},[We,s(" "+r(t.$t("searchteam.form.add")),1)])])):w("",!0)]),s(),et],64)):w("",!0),s(),e("div",tt,[e("label",null,r(t.$t("searchteam.table.goal")),1),s(),e("div",at,[y(e("select",{class:b([{error:(L=i.v$.fields)==null?void 0:L.goal.$error},"full-width"]),name:"goal","onUpdate:modelValue":n[3]||(n[3]=o=>a.fields.goal=o),tabindex:"1"},[e("option",st,"("+r(t.$t("searchteam.form.not_selected"))+")",1),s(),(c(!0),m(k,null,V(a.goals,o=>(c(),m("option",{value:o.id},r(o.title),9,nt))),256))],2),[[U,a.fields.goal,void 0,{number:!0}]]),s(),it])]),s(),e("div",ot,[e("label",null,r(t.$t("searchteam.table.comment")),1),s(),y(e("textarea",{class:b({error:(A=i.v$.fields)==null?void 0:A.comment.$error}),name:"comment","onUpdate:modelValue":n[4]||(n[4]=o=>a.fields.comment=o)},null,2),[[N,a.fields.comment]])]),s(),lt,s(),e("div",dt,[e("label",null,r(t.$t("searchteam.table.contact")),1),s(),e("div",rt,[$(u,{class:b({error:(M=i.v$.fields)==null?void 0:M.contact.phone.$error}),modelValue:a.fields.contact.phone,"onUpdate:modelValue":n[5]||(n[5]=o=>a.fields.contact.phone=o),name:"contact[phone]"},null,8,["class","modelValue"]),s(),e("div",ct,[$(v,{name:"phone"})])]),s(),e("div",mt,[y(e("input",{class:b({error:(R=i.v$.fields)==null?void 0:R.contact.email.$error}),name:"contact[email]",type:"email","onUpdate:modelValue":n[6]||(n[6]=o=>a.fields.contact.email=o)},null,2),[[N,a.fields.contact.email]]),s(),e("div",ut,[$(v,{name:"mail"})])]),s(),e("div",vt,[y(e("input",{name:"contact[vk]",type:"text","onUpdate:modelValue":n[7]||(n[7]=o=>a.fields.contact.vk=o)},null,512),[[N,a.fields.contact.vk]]),s(),e("div",ft,[$(v,{name:"vkontakte"})])])]),s(),ht,s(),e("div",_t,[e("div",{class:"checkbox",innerHTML:t.$t("forms.terms",{button:t.$t("searchteam.form.send")})},null,8,pt)]),s(),gt,s(),$(H,{callback:l.send,class:"btn-primary"},{default:oe(()=>[s(r(t.$t("searchteam.form.send")),1)]),_:1},8,["callback"])],32)}const St=G(qe,[["render",bt]]);export{St as S};
