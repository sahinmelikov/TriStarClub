import{r as N,c as _,G as V,D as I,o as s,a as m,w as k,aT as $,p as i,b as l,aH as T,d as r,t as d,F as C,q as B,m as D,az as F,e as R,C as U,aO as w}from"./bIp8vrNC.js";import{d as E}from"./3Ue6NacK.js";import{u as O}from"./BqTjkno-.js";const P={key:0,class:"radio"},x=["id","value"],M=["for"],S={__name:"PaymentCredit",props:{payment:{type:Object},price:{type:Number,default:0},modelValue:{type:Number,default:null}},emits:["update:modelValue"],setup(p,{emit:h}){const c=p,y=h,u=N(null),e=_({get(){return c.modelValue},set(v){y("update:modelValue",parseInt(v))}});a(),V(()=>c.price,()=>{a()});function a(){c.price<3e3||(u.value=null,I(E,{price:c.price}).then(({info:v})=>{u.value=v}))}return(v,f)=>p.price>=3e3?(s(),m("div",P,[k(l("input",{id:"payment_"+p.payment.id,type:"radio",name:"payment",value:p.payment.id,"onUpdate:modelValue":f[0]||(f[0]=b=>T(e)?e.value=b:null)},null,8,x),[[$,i(e)]]),r(),l("label",{for:"payment_"+p.payment.id},[r(d(p.payment.title)+" ",1),u.value?(s(),m(C,{key:0},[r("от "+d(u.value.amount)+" ₽/мес",1)],64)):B("",!0)],8,M)])):B("",!0)}},j={class:"form-group radio-group payment-group"},q={key:1,class:"radio"},z=["id","value"],A=["for"],G={key:0,class:"checkbox"},H={key:0,class:"checkbox"},L={for:"payment_internal"},Q={key:1,class:"radio"},J=["value"],K={for:"payment_internal"},W=l("div",{class:"form-divider"},null,-1),ee={__name:"Payments",props:{modelValue:{type:Number,default:0},price:{type:Number,default:0}},emits:["update:modelValue","payFromBalance"],setup(p,{emit:h}){const c=p,y=_(()=>c.price),u=N(!1),{payment:e}=D(O()),a=_({get(){return c.modelValue},set(t){f("update:modelValue",t)}}),v=_(()=>{let t=e.value.payments.find(o=>o.id===a.value);return!!(t&&t.code==="CREDIT")}),f=h;a.value===0&&e.value.payments.length>0&&(a.value=e.value.payments[0].id),b(!0),V(y,()=>{b()}),V(a,()=>{b()}),V(u,t=>{f("payFromBalance",t)},{immediate:!0});function b(t=!1){v.value?u.value=!1:e.value.internal&&e.value.internal.value>0&&(e.value.internal.value<y.value?(u.value=!0,a.value===e.value.internal.id&&(a.value=e.value.payments[0].id)):t&&F(()=>{a.value=e.value.internal.id}))}return(t,o)=>(s(),m("div",j,[l("label",null,d(t.$t("registration.payments"))+" *",1),r(),l("div",null,[(s(!0),m(C,null,R(i(e).payments,n=>(s(),m(C,null,[n.code==="CREDIT"?(s(),U(S,{key:n.id,payment:n,price:y.value,modelValue:a.value,"onUpdate:modelValue":o[0]||(o[0]=g=>a.value=g)},null,8,["payment","price","modelValue"])):(s(),m("div",q,[k(l("input",{id:"payment_"+n.id,type:"radio",name:"payment",value:n.id,"onUpdate:modelValue":o[1]||(o[1]=g=>a.value=g)},null,8,z),[[$,a.value,void 0,{number:!0}]]),r(),l("label",{for:"payment_"+n.id},d(n.title),9,A)]))],64))),256)),r(),i(e).internal&&i(e).internal.value>0&&!v.value?(s(),m("div",G,[i(e).internal.value<y.value?(s(),m("div",H,[k(l("input",{id:"payment_internal",type:"checkbox","onUpdate:modelValue":o[2]||(o[2]=n=>u.value=n)},null,512),[[w,u.value]]),r(),l("label",L,[r(d(t.$t("registration.balance.part"))+" ",1),l("b",null,"("+d(t.$t("registration.balance.my"))+": "+d(t.$formatCurrency(i(e).internal.value,i(e).internal.currency))+")",1)])])):(s(),m("div",Q,[k(l("input",{id:"payment_internal",type:"radio",name:"payment",value:i(e).internal.id,"onUpdate:modelValue":o[3]||(o[3]=n=>a.value=n)},null,8,J),[[$,a.value,void 0,{number:!0}]]),r(),l("label",K,[r(d(t.$t("registration.balance.full"))+" ",1),l("b",null,"("+d(t.$t("registration.balance.my"))+": "+d(t.$formatCurrency(i(e).internal.value,i(e).internal.currency))+")",1)])]))])):B("",!0)]),r(),W]))}};export{ee as _};
