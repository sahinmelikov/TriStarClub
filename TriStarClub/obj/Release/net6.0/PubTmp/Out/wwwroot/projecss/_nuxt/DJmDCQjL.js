import{_ as I,o as _,a as R,b as v,an as q,K as E,S as A,d as k,f as K,n as $}from"./bIp8vrNC.js";if(typeof x>"u")var x=window;var G=Object.create,L=Object.defineProperty,J=Object.getPrototypeOf,Q=Object.prototype.hasOwnProperty,tt=Object.getOwnPropertyNames,et=Object.getOwnPropertyDescriptor,it=t=>L(t,"__esModule",{value:!0}),w=(t,e)=>()=>(e||(e={exports:{}},t(e.exports,e)),e.exports),ot=(t,e,o)=>{if(it(t),e&&typeof e=="object"||typeof e=="function")for(let n of tt(e))!Q.call(t,n)&&n!=="default"&&L(t,n,{get:()=>e[n],enumerable:!(o=et(e,n))||o.enumerable});return t},nt=t=>t&&t.__esModule?t:ot(L(t!=null?G(J(t)):{},"default",{value:t,enumerable:!0}),t),F=w((t,e)=>{function o(n){var l=typeof n;return n!=null&&(l=="object"||l=="function")}e.exports=o}),st=w((t,e)=>{var o=typeof x=="object"&&x&&x.Object===Object&&x;e.exports=o}),H=w((t,e)=>{var o=st(),n=typeof self=="object"&&self&&self.Object===Object&&self,l=o||n||Function("return this")();e.exports=l}),at=w((t,e)=>{var o=H(),n=function(){return o.Date.now()};e.exports=n}),B=w((t,e)=>{var o=H(),n=o.Symbol;e.exports=n}),rt=w((t,e)=>{var o=B(),n=Object.prototype,l=n.hasOwnProperty,s=n.toString,a=o?o.toStringTag:void 0;function c(u){var f=l.call(u,a),d=u[a];try{u[a]=void 0;var r=!0}catch(g){}var m=s.call(u);return r&&(f?u[a]=d:delete u[a]),m}e.exports=c}),lt=w((t,e)=>{var o=Object.prototype,n=o.toString;function l(s){return n.call(s)}e.exports=l}),ht=w((t,e)=>{var o=B(),n=rt(),l=lt(),s="[object Null]",a="[object Undefined]",c=o?o.toStringTag:void 0;function u(f){return f==null?f===void 0?a:s:c&&c in Object(f)?n(f):l(f)}e.exports=u}),ct=w((t,e)=>{function o(n){return n!=null&&typeof n=="object"}e.exports=o}),ut=w((t,e)=>{var o=ht(),n=ct(),l="[object Symbol]";function s(a){return typeof a=="symbol"||n(a)&&o(a)==l}e.exports=s}),ft=w((t,e)=>{var o=F(),n=ut(),l=NaN,s=/^\s+|\s+$/g,a=/^[-+]0x[0-9a-f]+$/i,c=/^0b[01]+$/i,u=/^0o[0-7]+$/i,f=parseInt;function d(r){if(typeof r=="number")return r;if(n(r))return l;if(o(r)){var m=typeof r.valueOf=="function"?r.valueOf():r;r=o(m)?m+"":m}if(typeof r!="string")return r===0?r:+r;r=r.replace(s,"");var g=c.test(r);return g||u.test(r)?f(r.slice(2),g?2:8):a.test(r)?l:+r}e.exports=d}),dt=w((t,e)=>{var o=F(),n=at(),l=ft(),s="Expected a function",a=Math.max,c=Math.min;function u(f,d,r){var m,g,X,y,p,T,i=0,b=!1,M=!1,Y=!0;if(typeof f!="function")throw new TypeError(s);d=l(d)||0,o(r)&&(b=!!r.leading,M="maxWait"in r,X=M?a(l(r.maxWait)||0,d):X,Y="trailing"in r?!!r.trailing:Y);function S(h){var P=m,D=g;return m=g=void 0,i=h,y=f.apply(D,P),y}function N(h){return i=h,p=setTimeout(W,d),b?S(h):y}function U(h){var P=h-T,D=h-i,j=d-P;return M?c(j,X-D):j}function O(h){var P=h-T,D=h-i;return T===void 0||P>=d||P<0||M&&D>=X}function W(){var h=n();if(O(h))return C(h);p=setTimeout(W,U(h))}function C(h){return p=void 0,Y&&m?S(h):(m=g=void 0,y)}function Z(){p!==void 0&&clearTimeout(p),i=0,m=T=g=p=void 0}function V(){return p===void 0?y:C(n())}function z(){var h=n(),P=O(h);if(m=arguments,g=this,T=h,P){if(p===void 0)return N(T);if(M)return clearTimeout(p),p=setTimeout(W,d),S(T)}return p===void 0&&(p=setTimeout(W,d)),y}return z.cancel=Z,z.flush=V,z}e.exports=u}),mt=nt(dt()),pt=mt.default;function gt(){let t=[],e=[];function o(i,b){i.forEach(M=>{M.call(null,b)})}this.onSingleTap=function(i){typeof i=="function"&&!t.includes(i)&&t.push(i)},this.onDoubleTap=function(i){typeof i=="function"&&!e.includes(i)&&e.push(i)},this.attach=function(i){if(!(i instanceof Element)){console.error("TapDetector.attach: arg must be an Element");return}i.addEventListener("touchstart",f),i.addEventListener("touchmove",r),i.addEventListener("touchend",d),i.addEventListener("mousedown",m),i.addEventListener("mouseup",g),i.addEventListener("mousemove",X)},this.detach=function(i){i.removeEventListener("touchstart",f),i.removeEventListener("touchmove",r),i.removeEventListener("touchend",d),i.removeEventListener("mousedown",m),i.removeEventListener("mouseup",g),i.removeEventListener("mousemove",X)};let n=!1,l=0,s=0,a=0,c=0,u=0;function f(i){n=!0,i.touches.length===1&&y(i.touches[0].clientX,i.touches[0].clientY)}function d(i){i.touches.length===0&&p()}function r(i){i.touches.length===1&&T(i.touches[0].clientX,i.touches[0].clientY)}function m(i){n||y(i.clientX,i.clientY)}function g(i){n||p()}function X(i){n||i.button===0&&T(i.clientX,i.clientY)}function y(i,b){c=i,u=b,a=0}function p(){let i=Date.now();a<10&&(i-l<300?s+=1:s=1,l=Date.now(),o(t,{clientX:c,clientY:u}),s===2&&(o(e,{clientX:c,clientY:u}),s=0)),a=0}function T(i,b){let M=c-i,Y=u-b,S=Math.sqrt(M*M+Y*Y);a+=S,c=i,u=b}}const wt={props:{minScale:{type:Number,default:1},maxScale:{type:Number,default:5},zoomed:{type:Boolean,default:!1},resetTrigger:{type:Number,default:1e5},aspectRatio:{type:Number,default:1},backgroundColor:{type:String,default:"transparent"},pivot:{type:String,default:"cursor"},zoomingElastic:{type:Boolean,default:!0},limitTranslation:{type:Boolean,default:!0},doubleClickToZoom:{type:Boolean,default:!0},mouseWheelToZoom:{type:Boolean,default:!0}},data(){return{containerWidth:1,containerHeight:1,containerLeft:0,containerTop:0,translateX:0,animTranslateX:0,translateY:0,animTranslateY:0,scale:1,animScale:1,lastFullWheelTime:0,lastWheelTime:0,lastWheelDirection:"y",isPointerDown:!1,pointerPosX:-1,pointerPosY:-1,twoFingerInitDist:0,panLocked:!0,raf:null,tapDetector:null}},computed:{wrapperStyle(){let t=this.containerWidth*this.animTranslateX,e=this.containerHeight*this.animTranslateY;return{transform:["translate(".concat(t,"px, ").concat(e,"px)"),"scale(".concat(this.animScale,")")].join(" ")}}},watch:{scale(t){t!==1&&(this.$emit("update:zoomed",!0),this.panLocked=!1)},resetTrigger:"reset"},mounted(){this.tapDetector=new gt,this.tapDetector.attach(this.$refs.root),this.doubleClickToZoom&&this.tapDetector.onDoubleTap(this.onDoubleTap),window.addEventListener("resize",this.onWindowResize),this.onWindowResize(),this.refreshContainerPos(),this.loop()},beforeUnmount(){this.tapDetector.detach(this.$refs.root),window.removeEventListener("resize",this.onWindowResize),window.cancelAnimationFrame(this.raf)},methods:{reset(){this.scale=1,this.panLocked=!0,this.translateX=0,this.translateY=0},zoomIn(t=2){this.tryToScale(t),this.onInteractionEnd()},zoomOut(t=.5){this.tryToScale(t),this.onInteractionEnd()},tryToScale(t){let e=this.scale*t;if(this.zoomingElastic){if(e<this.minScale||e>this.maxScale){let o=Math.log2(t);o*=.2,t=Math.pow(2,o),e=this.scale*t}}else e<this.minScale?e=this.minScale:e>this.maxScale&&(e=this.maxScale);if(t=e/this.scale,this.scale=e,this.pivot!=="image-center"){let o=(this.pointerPosX-this.containerLeft)/this.containerWidth,n=(this.pointerPosY-this.containerTop)/this.containerHeight;this.translateX=(.5+this.translateX-o)*t+o-.5,this.translateY=(.5+this.translateY-n)*t+n-.5}},setPointerPosCenter(){this.pointerPosX=this.containerLeft+this.containerWidth/2,this.pointerPosY=this.containerTop+this.containerHeight/2},onPointerMove(t,e){if(this.isPointerDown){let o=t-this.pointerPosX,n=e-this.pointerPosY;this.panLocked||(this.translateX+=o/this.containerWidth,this.translateY+=n/this.containerHeight)}this.pointerPosX=t,this.pointerPosY=e},onInteractionEnd:pt(function(){this.limit(),this.panLocked=this.scale===1,this.$emit("update:zoomed",!this.panLocked)},100),limit(){if(this.scale<this.minScale?this.scale=this.minScale:this.scale>this.maxScale&&this.tryToScale(this.maxScale/this.scale),this.limitTranslation){let t=this.calcTranslateLimit();Math.abs(this.translateX)>t.x&&(this.translateX*=t.x/Math.abs(this.translateX)),Math.abs(this.translateY)>t.y&&(this.translateY*=t.y/Math.abs(this.translateY))}},calcTranslateLimit(){if(this.getMarginDirection()==="y"){let t=this.containerWidth/this.aspectRatio/this.containerHeight,e=(this.scale*t-1)/2;return e<0&&(e=0),{x:(this.scale-1)/2,y:e}}else{let t=this.containerHeight*this.aspectRatio/this.containerWidth,e=(this.scale*t-1)/2;return e<0&&(e=0),{x:e,y:(this.scale-1)/2}}},getMarginDirection(){return this.containerWidth/this.containerHeight>this.aspectRatio?"x":"y"},onDoubleTap(t){this.scale===1?(t.clientX>0&&(this.pointerPosX=t.clientX,this.pointerPosY=t.clientY),this.tryToScale(Math.min(3,this.maxScale))):this.reset(),this.onInteractionEnd()},onWindowResize(){let t=window.getComputedStyle(this.$refs.root);this.containerWidth=parseFloat(t.width),this.containerHeight=parseFloat(t.height),this.setPointerPosCenter(),this.limit()},refreshContainerPos(){let t=this.$refs.root.getBoundingClientRect();this.containerLeft=t.left,this.containerTop=t.top},loop(){this.animScale=this.gainOn(this.animScale,this.scale),this.animTranslateX=this.gainOn(this.animTranslateX,this.translateX),this.animTranslateY=this.gainOn(this.animTranslateY,this.translateY),this.raf=window.requestAnimationFrame(this.loop)},gainOn(t,e){let o=(e-t)*.3;return Math.abs(o)>1e-5?t+o:e},onMouseWheel(t){if(!this.mouseWheelToZoom)return;t.preventDefault(),t.detail&&(t.wheelDelta=t.detail*-10);let e=Date.now();Math.abs(t.wheelDelta)===120?e-this.lastFullWheelTime>50&&(this.onMouseWheelDo(t.wheelDelta),this.lastFullWheelTime=e):(e-this.lastWheelTime>50&&typeof t.deltaX=="number"&&(this.lastWheelDirection=t.detail==0&&Math.abs(t.deltaX)>Math.abs(t.deltaY)?"x":"y",this.lastWheelDirection==="x"&&this.$emit("swipe",t.deltaX>0?"left":"right")),this.lastWheelDirection==="y"&&this.onMouseWheelDo(t.wheelDelta)),this.lastWheelTime=e},onMouseWheelDo(t){let e=Math.pow(1.25,t/120);this.tryToScale(e),this.onInteractionEnd()},onMouseDown(t){this.refreshContainerPos(),this.isPointerDown=!0,this.pointerPosX=t.clientX,this.pointerPosY=t.clientY},onMouseUp(t){this.isPointerDown=!1,this.onInteractionEnd()},onMouseMove(t){this.onPointerMove(t.clientX,t.clientY)},onTouchStart(t){if(t.touches.length===1)this.refreshContainerPos(),this.pointerPosX=t.touches[0].clientX,this.pointerPosY=t.touches[0].clientY,this.isPointerDown=!0;else if(t.touches.length===2){this.isPointerDown=!0,this.pointerPosX=(t.touches[0].clientX+t.touches[1].clientX)/2,this.pointerPosY=(t.touches[0].clientY+t.touches[1].clientY)/2;let e=t.touches[0].clientX-t.touches[1].clientX,o=t.touches[0].clientY-t.touches[1].clientY;this.twoFingerInitDist=Math.sqrt(e*e+o*o)}},onTouchEnd(t){t.touches.length===0?(this.isPointerDown=!1,Math.abs(this.scale-1)<.1&&(this.scale=1),this.onInteractionEnd()):t.touches.length===1&&(this.pointerPosX=t.touches[0].clientX,this.pointerPosY=t.touches[0].clientY)},onTouchMove(t){if(t.touches.length===1)this.onPointerMove(t.touches[0].clientX,t.touches[0].clientY);else if(t.touches.length===2){let e=(t.touches[0].clientX+t.touches[1].clientX)/2,o=(t.touches[0].clientY+t.touches[1].clientY)/2;this.onPointerMove(e,o),this.pointerPosX=e,this.pointerPosY=o;let n=t.touches[0].clientX-t.touches[1].clientX,l=t.touches[0].clientY-t.touches[1].clientY,s=Math.sqrt(n*n+l*l);this.tryToScale(s/this.twoFingerInitDist),this.twoFingerInitDist=s}}}};function Tt(t,e,o,n,l,s){return _(),R("div",{ref:"root",class:"vue-zoomer",style:E({backgroundColor:o.backgroundColor}),onMousewheel:e[0]||(e[0]=(...a)=>s.onMouseWheel&&s.onMouseWheel(...a)),"on:DOMMouseScroll":e[1]||(e[1]=(...a)=>s.onMouseWheel&&s.onMouseWheel(...a)),onMousedown:e[2]||(e[2]=(...a)=>s.onMouseDown&&s.onMouseDown(...a)),onMouseup:e[3]||(e[3]=(...a)=>s.onMouseUp&&s.onMouseUp(...a)),onMousemove:e[4]||(e[4]=(...a)=>s.onMouseMove&&s.onMouseMove(...a)),onMouseout:e[5]||(e[5]=(...a)=>s.setPointerPosCenter&&s.setPointerPosCenter(...a)),onTouchstart:e[6]||(e[6]=(...a)=>s.onTouchStart&&s.onTouchStart(...a)),onTouchend:e[7]||(e[7]=(...a)=>s.onTouchEnd&&s.onTouchEnd(...a)),onTouchmove:e[8]||(e[8]=(...a)=>s.onTouchMove&&s.onTouchMove(...a))},[v("div",{class:"zoomer",style:E(s.wrapperStyle)},[q(t.$slots,"default",{},void 0,!0)],4)],36)}const Mt=I(wt,[["render",Tt],["__scopeId","data-v-2e65fed4"]]),yt={name:"routeMap",components:{VZoomer:Mt},props:{image:{type:Object}},data(){return{width:400}},mounted(){this.calculateWidth(),window.addEventListener("resize",this.calculateWidth)},beforeUnmount(){window.removeEventListener("resize",this.calculateWidth)},methods:{calculateWidth(){let t=window.innerHeight-100;if(t<this.image.height){let e=this.image.width/this.image.height;this.width=Math.min(Math.floor(t*e),window.innerWidth-40)}},zoomIn(){this.$refs.zoomer.zoomIn(1.25)},zoomOut(){this.$refs.zoomer.zoomOut(.75)}}},bt={class:"wrap-modal-map"},vt={class:"map-control"},Pt=v("i",{class:"icon-plus icon"},null,-1),Xt=[Pt],Yt=v("i",{class:"icon-minus icon"},null,-1),St=[Yt],Dt={class:"panzoom-parent",id:"viewport"},xt=["src"];function Wt(t,e,o,n,l,s){const a=A("v-zoomer");return _(),R("div",{class:"modal-map-wrap",style:E({width:l.width+"px"})},[v("div",bt,[v("div",vt,[v("div",{class:"zoom",onClick:e[0]||(e[0]=(...c)=>s.zoomIn&&s.zoomIn(...c))},Xt),k(),v("div",{class:"zoomBack",onClick:e[1]||(e[1]=(...c)=>s.zoomOut&&s.zoomOut(...c))},St)]),k(),v("div",Dt,[K(a,{ref:"zoomer"},{default:$(()=>[v("img",{class:"panzoom",src:o.image.src,alt:""},null,8,xt)]),_:1},512)])])],4)}const Et=I(yt,[["render",Wt]]);export{Et as default};
