import{_ as w}from"./vTIBdjwe.js";import{_ as D,D as _,z as f,N as u,O as R,Q as S,R as d,I as L,S as r,o as l,a as c,b as s,f as a,d as n,n as M,t as h,T as N,p as v,F as P,e as B,P as U,k as g,y as j,C as z}from"./bIp8vrNC.js";import{_ as A}from"./DH3-Mkvj.js";import{E as V,_ as b,d as y}from"./DspA-NJo.js";import{d as O}from"./CyvmEBDe.js";import{_ as Q}from"./CWI3wdPG.js";import{E as q}from"./BFduWOoW.js";import"./CyCUcgYy.js";import"./BvQgWdB0.js";import"./z1mF-5nA.js";import"./ItgtrmpN.js";import"./BfWe1yh-.js";const E=6,K=O({name:"page-results",components:{EventItem:Q,EventFilter:V,EventTypes:q,TotalRaces:b},asyncData:async()=>{let t,e,o=_(y,{limit:E,page:parseInt(f().params.page||1)||1,sort:{date:"desc"},filter:{"<date":u().add(1,"day").tz().format("DD.MM.YYYY")},key:f().path},"cache-first");return[t,e]=R(()=>Promise.all([o,g().getPageInfo()]).then(([{events:m,filter:p}])=>({...m,filter:p.items}))),t=await t,e(),t},data:()=>({items:[],pagination:null,filter:null}),computed:{...S(g,["eventsTypes"])},methods:{toggleFilter:d,getFilterString(){let t={};return this.filter.forEach(e=>{e.values.forEach(o=>{o.checked&&(t[o.id]="Y")})}),Object.keys(t).map(e=>encodeURIComponent(e)+"="+encodeURIComponent(t[e])).join("&")},async load(t){t=t||1,t<1&&(t=1);try{let e=await _(y,{page:t,limit:E,sort:{date:"desc"},filter:{"<date":u().add(1,"day").tz().format("DD.MM.YYYY")},key:this.getFilterString()}).then(o=>o);e&&e.events&&(t>1?this.items=this.items.concat(e.events.items):this.items=e.events.items,this.pagination=e.events.pagination,this.filter=e.filter?e.filter.items:[],history.replaceState(null,null,e.filter.url))}catch(e){L(e)}}}},"$2fKvfsLiDA"),x={class:"content-block events events-page"},G={class:"container"},H={class:"inner-head"},J={class:"inner-head-left"},W={class:"inner-head-right"},X={class:"content-block-wrap"},Z={class:"content-block-main"},tt={class:"event-list"},et={class:"row"},st={class:"col-6 col-xxs-12"},nt={class:"content-block-aside"};function ot(t,e,o,m,p,at){const k=w,F=j,I=r("EventItem"),T=A,$=r("EventFilter"),C=b,Y=r("EventTypes");return l(),c("div",null,[s("section",x,[s("div",G,[s("div",H,[s("div",J,[a(k)]),n(),s("div",W,[a(F,{to:"/event/",class:"btn btn-white button-small"},{default:M(()=>[n(h(t.$t("events.calendar")),1)]),_:1}),n(),s("a",{onClick:e[0]||(e[0]=N((...i)=>("toggleFilter"in t?t.toggleFilter:v(d))&&("toggleFilter"in t?t.toggleFilter:v(d))(...i),["prevent"])),href:"",class:"aside-btn btn btn-white btn-default"},h(t.$t("events.filter.title")),1)])]),n(),s("div",X,[s("div",Z,[s("div",tt,[s("div",et,[(l(!0),c(P,null,B(t.items,i=>(l(),c("div",st,[(l(),z(I,{key:i.id,item:i},null,8,["item"]))]))),256))])]),n(),a(T,{url:(t._.provides[U]||t.$route).fullPath,data:t.pagination,type:2,onChange:t.load},null,8,["url","data","onChange"])]),n(),s("aside",nt,[a($,{items:t.filter,onUpdate:t.load},null,8,["items","onUpdate"])])])])]),n(),a(C),n(),a(Y,{types:t.eventsTypes},null,8,["types"])])}const gt=D(K,[["render",ot]]);export{gt as default};
