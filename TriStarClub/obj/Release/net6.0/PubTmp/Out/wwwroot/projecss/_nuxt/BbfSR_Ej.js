import{_ as F}from"./vTIBdjwe.js";import{_ as N,D as f,N as c,z as $,O as R,u as w,Q as A,R as p,S as d,o as r,a as m,b as n,f as i,d as o,n as D,t as h,T as O,p as u,F as j,e as P,k as v,y as L,C as M}from"./bIp8vrNC.js";import{E as U,_ as y,d as g}from"./DspA-NJo.js";import{_ as x}from"./DT5KE1-1.js";import{d as z}from"./CyvmEBDe.js";import{_ as B}from"./CWI3wdPG.js";import{E as V}from"./BFduWOoW.js";import"./CyCUcgYy.js";import"./BvQgWdB0.js";import"./z1mF-5nA.js";import"./ItgtrmpN.js";import"./BfWe1yh-.js";const E=9999,Q=z({name:"page-event",components:{EventItem:B,EventFilter:U,EventTypes:V,TotalRaces:y},asyncData:async()=>{let t,e,s=f(g,{limit:E,sort:{date:"asc"},filter:{">=date":c().tz().format("DD.MM.YYYY")},key:$().path},"cache-first");return[t,e]=R(()=>Promise.all([s,v().getPageInfo()]).then(([{events:a,filter:_}])=>({items:a.items,filter:_.items}))),t=await t,e(),t},data:()=>({items:[],filter:[],types:[]}),created(){w({title:this.title,meta:[{hid:"description",name:"description",content:this.$i18n.locale==="ru"?this.title+" ✅ Регистрация онлайн 📅 расписание спортивных мероприятий на сайте IRONSTAR":null}]})},computed:{...A(v,["page","eventsTypes"]),title(){let t=this.page.title||"";if(this.$i18n.locale==="ru"&&this.filter){let e={CITY:[],SEASON:[],TYPE:[]};this.filter.forEach(s=>{s.code!=="CITY"&&s.code!=="SEASON"&&s.code!=="TYPE"||s.values.forEach(a=>{a.checked&&e[s.code].push(a.title)})}),e.CITY.length>0&&(t+=" в г. "+e.CITY.join(", ")),e.TYPE.length>0&&(t+=": "+e.TYPE.join(", ")),t+=" - расписание стартов в ",e.SEASON.length>0?t+=e.SEASON.join(", "):t+=c().tz().format("YYYY")}return t}},methods:{toggleFilter:p,getFilterString(){let t={};return this.filter.forEach(e=>{e.values.forEach(s=>{s.checked&&(t[s.id]="Y")})}),Object.keys(t).map(e=>encodeURIComponent(e)+"="+encodeURIComponent(t[e])).join("&")},async updateItems(){try{const[t,e]=await f(g,{page:1,limit:E,sort:{date:"asc"},filter:{">=date":c().tz().format("DD.MM.YYYY")},key:this.getFilterString()}).then(s=>[s.events,s.filter]);this.items=t.items,this.filter=e.items,history.replaceState(null,null,e.url)}catch(t){console.log(t.message)}}}},"$ZcCZEm5Wel"),Z={class:"content-block events events-page"},q={class:"container"},H={class:"inner-head"},W={class:"inner-head-left"},G={class:"inner-head-right"},J={class:"content-block-wrap"},K={class:"content-block-main"},X={class:"event-list"},tt={class:"row"},et={class:"col-6 col-xxs-12"},st={class:"content-block-aside"};function nt(t,e,s,a,_,ot){const Y=F,T=L,S=d("EventItem"),k=d("EventFilter"),I=y,b=d("EventTypes"),C=x;return r(),m("div",null,[n("section",Z,[n("div",q,[n("div",H,[n("div",W,[i(Y)]),o(),n("div",G,[i(T,{to:"/results/",class:"btn btn-white button-small"},{default:D(()=>[o(h(t.$t("events.archive")),1)]),_:1}),o(),n("a",{onClick:e[0]||(e[0]=O((...l)=>("toggleFilter"in t?t.toggleFilter:u(p))&&("toggleFilter"in t?t.toggleFilter:u(p))(...l),["prevent"])),href:"",class:"aside-btn btn btn-white btn-default"},h(t.$t("events.filter.title")),1)])]),o(),n("div",J,[n("div",K,[n("div",X,[n("div",tt,[(r(!0),m(j,null,P(t.items,l=>(r(),m("div",et,[(r(),M(S,{key:l.id,item:l},null,8,["item"]))]))),256))])])]),o(),n("aside",st,[i(k,{items:t.filter,onUpdate:t.updateItems},null,8,["items","onUpdate"])])])])]),o(),i(I),o(),i(b,{types:t.eventsTypes},null,8,["types"]),o(),i(C)])}const vt=N(Q,[["render",nt]]);export{vt as default};
